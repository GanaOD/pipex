# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    commands.txt                                       :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: go-donne <go-donne@student.42.fr>          +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2025/01/21 09:06:27 by go-donne          #+#    #+#              #
#    Updated: 2025/01/23 12:43:34 by go-donne         ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­

â­	CORE FUNCTIONALITY	â­
Basic Pipe Operations (1 pipe connecting 2 commands, testing data transformation & flow)

â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­


ğŸ”¥ğŸ”¥ğŸ”¥
./pipex test/infiles/single_line.txt "cat" "wc -l" output.txt
Should output 1 line



ğŸ”¥ğŸ”¥ğŸ”¥
âš¡	./pipex test/infiles/single_line.txt "tr a-z A-Z" "cat" output.txt

ğŸš
	tr: translate chars
	Convert line to uppercase

ğŸŒ¿	< infile tr 'a-z' 'A-Z' | cat > outfile



ğŸ”¥ğŸ”¥ğŸ”¥

./pipex test/infiles/single_line.txt "tr a-z A-Z" "rev" output.txt

ğŸš	Converts text to uppercase then reverses each line




ğŸ”¥ğŸ”¥ğŸ”¥
./pipex test/infiles/single_line.txt "tr -cd '[:alpha:]'" "tr -cd 'aeiou'" output.txt

ğŸŒ¿	< infile tr -cd '[:alpha:]' | tr -cd 'aeiou' > outfile

ğŸš: Keeps only letters then keeps only vowels
Breakdown:
cmd1:
-c					complement (invert the selection)
-d					delete (remove instead of translate)
-cd '[:alpha:]'		delete everything EXCEPT (-c) alphabetic characters (in this case, just spaces)
([:alnum:]			a-zA-Z0-9)

Result: "Alonehemovedwatchedbytheinfinity"

cmd2:
tr -cd 'aeiou'		delete everything EXCEPT (-c) vowels
Keeps only vowels
Result should be: "oeeoeaeeiii"





â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­

â­	EDGE CASES	â­

â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­


ğŸ”¥	Empty File Handling

ğŸ”¥ğŸ”¥ğŸ”¥
./pipex test/infiles/empty.txt "cat" "wc -l" output.txt
ğŸš	0 lines

ğŸ”¥ğŸ”¥ğŸ”¥
./pipex test/infiles/empty.txt "grep anything" "wc -w" output.txt
ğŸš	0 words



ğŸ”¥	Hidden Files

ğŸ”¥ğŸ”¥ğŸ”¥
./pipex test/infiles/.hidden "cat" "wc -l" output.txt
Basic hidden file reading

ğŸ”¥ğŸ”¥ğŸ”¥
./pipex test/infiles/.hidden "grep spirit" "wc -l" output.txt
Search in hidden file
With my current .hidden content:
	grepping "spirit": wc -l == 4
	grepping "it": wc -l == 12

(For searching for a pattern that does not occur, see error handling below)





â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­


â­	RESOURCE HANDLING	â­

â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­

ğŸ”¥	Large File Processing

ğŸ”¥ğŸ”¥ğŸ”¥
./pipex test/infiles/large.txt "cat" "head -n 10" output.txt
Get first 10 lines

ğŸ”¥ğŸ”¥ğŸ”¥
./pipex test/infiles/large.txt "tail -n 5" "sort" output.txt
Sort last 5 lines





â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­


â­	PERMISSION & ACCESS CONTROL	â­

â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­


ğŸ”¥	Input File Permissions


ğŸ”¥ğŸ”¥ğŸ”¥
# Zero permissions

ğŸŒ¿
touch infile
chmod 000 infile
< infile cmd1 | cmd2 > outfile
(where cmd1 & 2 are valid cmds)

ğŸš	zsh: permission denied: infile

âš¡
Set-up: chmod 000 test/infiles/permissions.txt
Proof: ls -la test/infiles
./pipex test/infiles/permissions.txt "cat" "wc -l" output.txt
Custom error message from handle_first_child matches bash format (see below): pipex: permission denied: test/infiles/permissions.txt



ğŸ”¥ğŸ”¥ğŸ”¥
# Executable-only

chmod 111 test/infiles/exec_only.txt
./pipex test/infiles/exec_only.txt "cat" "wc -l" output.txt

ğŸš	Same output format as with zero permissions






ğŸ”¥	Output Directory Permissions

ğŸ”¥ğŸ”¥ğŸ”¥
ğŸŒ¿
mkdir -p readonly
chmod 444 readonly
< infile cat | wc -l > readonly/output.txt

ğŸš	zsh: permission denied: readonly/output.txt

âš¡
mkdir -p test/readonly
chmod 444 test/readonly (r--r--r--)
./pipex test/infiles/single_line.txt "cat" "wc -l" test/readonly/output.txt

pipex: permission denied: test/readonly/output.txt




â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­

â­	ERROR HANDLING	â­

â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­

General behaviour: Pipe flow not exited: error messages passed through & operated on



ğŸ”¥	Non-existent Commands


ğŸ”¥ğŸ”¥ğŸ”¥
# cmd1 non-existent, cmd2 valid

ğŸŒ¿	< infile nonexistent | wc > output

ğŸš
< infile nonexistent	: redirects stdin from infile. Cmd1 fails & produces error message ("Command not found: nonexistent").
This error message is passed into pipe (not stderr)
Cmd2 operates on error message, passes output to outfile
Hence with cmd2 == wc: output content:
       1       4      31
(from error message: "Command not found: nonexistent")

âš¡
./pipex test/infiles/single_line.txt "nonexistent" "wc" output.txt



ğŸ”¥ğŸ”¥ğŸ”¥
# cmd1 valid, cmd2 non-existent

ğŸŒ¿	< infile cat | nonexistent > outfile

ğŸš
Error message written to stdout & âˆ´ outfile:
Command not found: nonexistent

âš¡
./pipex test/infiles/single_line.txt "cat" "nonexistent" output.txt




ğŸ”¥	Non-existent Files

ğŸŒ¿
< nonexistent cat | wc > outfile

ğŸš
zsh: no such file or directory: nonexistent

âš¡
./pipex test/infiles/nonexistent.txt "cat" "wc" output.txt










âš ï¸	âš ï¸	âš ï¸	âš ï¸
CONTINUE HERE WITH v2. (all previous tests are ok, not all of the following verified)
âš ï¸	âš ï¸	âš ï¸	âš ï¸




ğŸ”¥	Invalid Arguments to Commands

./pipex test/infiles/single_line.txt "wc -invalid" "cat" output.txt




ğŸ”¥	Pattern Matching Edge Cases

# Valid command that finds no matches

./pipex test/infiles/.hidden "grep nonexistent_pattern" "wc -l" output.txt

ğŸš	output 0, continue pipeline






â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­

â­	SPECIAL FILES	â­

â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­


ğŸ”¥
# Test with /dev/null

ğŸ”¥ğŸ”¥ğŸ”¥
./pipex /dev/null "cat" "wc -l" output.txt
ğŸš	0

ğŸ”¥ğŸ”¥ğŸ”¥
./pipex test/infiles/single_line.txt "cat" "wc -l" /dev/null



ğŸ”¥
# Test with /dev/zero

ğŸŒ¿	< /dev/zero head -c 10 | xxd > outfile
ğŸš	00000000: 0000 0000 0000 0000 0000                 ..........
âš¡	./pipex /dev/zero "head -c 10" "xxd" output.txt
	00000000: 0000 0000 0000 0000 0000                 ..........


ğŸ”¥
# Test with /dev/urandom
./pipex /dev/urandom "head -c 10" "xxd" output.txt






â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­

â­		MEMORY MANAGEMENT						â­

â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­	â­

ğŸ”¥	Run with valgrind to check for leaks & access errors:

Replace "infile" with 

# Basic test
valgrind --leak-check=full --show-leak-kinds=all ./pipex infile "ls -l" "wc -l" outfile

# Test with non-existent command
valgrind --leak-check=full --show-leak-kinds=all ./pipex infile "nonexistent" "wc -l" outfile

# Test with invalid files
valgrind --leak-check=full --show-leak-kinds=all ./pipex nonexistent "ls" "wc" outfile



ğŸ”¥	Run with address sanitizer

# Compile with -fsanitize=address and test core functionality
